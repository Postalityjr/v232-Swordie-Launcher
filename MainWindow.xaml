<Window x:Class="v232.Launcher.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:gif="http://wpfanimatedgif.codeplex.com"
        Title="RoyalStory Launcher"
        Height="720"
        Width="1280"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Icon="Assets/Slime.ico">

    <!-- Main Container -->
    <Border x:Name="MainBorder" CornerRadius="12"
            Background="{DynamicResource BackgroundDeepBrush}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect BlurRadius="30" ShadowDepth="0" Color="#000000" Opacity="0.5"/>
        </Border.Effect>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="440"/>
            </Grid.ColumnDefinitions>

            <!-- GIF Background for Classic/Orange theme -->
            <Image x:Name="GifBackgroundClassic"
                   Grid.ColumnSpan="2"
                   Stretch="UniformToFill"
                   Opacity="0.6"/>
            <Border x:Name="GifOverlayClassic" Grid.ColumnSpan="2" Background="#50000000"/>

            <!-- GIF Background for Neon theme -->
            <Image x:Name="GifBackgroundNeon"
                   Grid.ColumnSpan="2"
                   Stretch="UniformToFill"
                   Opacity="0.65"
                   Visibility="Collapsed"/>
            <Border x:Name="GifOverlayNeon" Grid.ColumnSpan="2" Background="#45000000" Visibility="Collapsed"/>

            <!-- ═══════════════════════════════════════════════════════════════ -->
            <!-- LEFT PANEL - Branding & Info                                     -->
            <!-- ═══════════════════════════════════════════════════════════════ -->
            <Border x:Name="LeftPanel" Grid.Column="0" CornerRadius="12,0,0,12">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#0A0A0A" Offset="0"/>
                        <GradientStop Color="#0F0F0F" Offset="0.5"/>
                        <GradientStop Color="#0A0A0A" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>

                <Grid>
                    <!-- Drag Area for Left Panel -->
                    <Border Background="#01000000" Height="50" VerticalAlignment="Top"
                            MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"/>

                <Grid Margin="60,50">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Top - Title & Status -->
                    <StackPanel Grid.Row="0">
                        <StackPanel Orientation="Horizontal">
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="RoyalStory" FontSize="32" FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryAccentBrush}"/>
                                <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                    <Border Background="{DynamicResource BackgroundElevatedBrush}" CornerRadius="4"
                                            Padding="8,3" Margin="0,0,10,0">
                                        <TextBlock Text="v232" FontSize="11" Foreground="{DynamicResource PrimaryAccentBrush}"/>
                                    </Border>
                                    <Ellipse x:Name="StatusDot" Width="8" Height="8" VerticalAlignment="Center" Margin="0,0,6,0">
                                        <Ellipse.Style>
                                            <Style TargetType="Ellipse">
                                                <Setter Property="Fill" Value="{DynamicResource SuccessBrush}"/>
                                            </Style>
                                        </Ellipse.Style>
                                    </Ellipse>
                                    <TextBlock x:Name="StatusText" Text="Online" FontSize="11"
                                               Foreground="{DynamicResource SuccessBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>


                    <!-- Bottom - Footer Only -->
                    <StackPanel Grid.Row="2">
                        <!-- Footer -->
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="v1.0.0.14" FontSize="11" Foreground="{DynamicResource TextMutedBrush}"/>
                            <TextBlock Text="  |  " FontSize="11" Foreground="{DynamicResource TextMutedBrush}"/>
                            <TextBlock Text="Made/Designed by " FontSize="11" Foreground="{DynamicResource TextMutedBrush}"/>
                            <TextBlock Text="Lynx" FontSize="11" Foreground="{DynamicResource PrimaryAccentBrush}" FontWeight="SemiBold"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
                </Grid>
            </Border>

            <!-- ═══════════════════════════════════════════════════════════════ -->
            <!-- RIGHT PANEL - Auth Card                                          -->
            <!-- ═══════════════════════════════════════════════════════════════ -->
            <Border x:Name="RightPanel" Grid.Column="1"
                    Background="{DynamicResource BackgroundCardBrush}"
                    CornerRadius="0,12,12,0"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1,0,0,0">
                <Grid>
                    <!-- Drag Area (must be first so buttons render on top) -->
                    <Border Background="#01000000" Height="50" VerticalAlignment="Top"
                            MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"/>

                    <!-- Window Controls (rendered on top of drag area) -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,15,15,0">
                        <Button Style="{DynamicResource IconButton}" Click="MinimizeButton_Click">
                            <Path Data="M0,5 H10" Stroke="{DynamicResource TextSecondaryBrush}" StrokeThickness="1.5" Width="10" Height="10"/>
                        </Button>
                        <Button Style="{DynamicResource CloseButton}" Click="CloseButton_Click">
                            <Path Data="M0,0 L10,10 M10,0 L0,10" Stroke="{DynamicResource TextSecondaryBrush}" StrokeThickness="1.5" Width="10" Height="10"/>
                        </Button>
                    </StackPanel>

                    <!-- Theme & Music Controls (above login) -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="50,60,0,0">
                        <!-- Theme Toggle (small) -->
                        <Border x:Name="ThemeToggleButton" Background="{DynamicResource BackgroundElevatedBrush}"
                                CornerRadius="6" Padding="8,6" Cursor="Hand"
                                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                                MouseEnter="ThemeToggle_MouseEnter" MouseLeave="ThemeToggle_MouseLeave"
                                MouseLeftButtonUp="ThemeToggle_Click">
                            <StackPanel Orientation="Horizontal">
                                <Path x:Name="ThemeIcon" Data="M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A9,9 0 0,0 21,12C21,11.5 20.96,11 20.87,10.5C20.6,12 20,13.2 19.1,14.1C18.2,15 17,15.6 15.5,15.87C15,15.96 14.5,16 14,16A5,5 0 0,1 9,11A5,5 0 0,1 14,6C14.5,6 15,6.04 15.5,6.13C14.2,5.4 12.7,5 11.1,5C10.7,4.93 10.35,4.9 10,4.9C6.13,4.9 3,8.03 3,12"
                                      Fill="{DynamicResource PrimaryAccentBrush}" Width="12" Height="12" Stretch="Uniform"
                                      VerticalAlignment="Center"/>
                                <TextBlock x:Name="ThemeToggleText" Text="Neon" FontSize="11" Margin="6,0,0,0"
                                           Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Music Player (small) -->
                        <Border Background="{DynamicResource BackgroundElevatedBrush}"
                                CornerRadius="6" Padding="6,6" Margin="8,0,0,0"
                                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                            <StackPanel Orientation="Horizontal">
                                <!-- Play/Pause Button -->
                                <Border x:Name="PlayPauseButton" Width="24" Height="24" CornerRadius="12"
                                        Background="{DynamicResource BackgroundCardBrush}"
                                        Cursor="Hand" MouseLeftButtonUp="PlayPause_Click"
                                        MouseEnter="PlayPause_MouseEnter" MouseLeave="PlayPause_MouseLeave">
                                    <Path x:Name="PlayPauseIcon"
                                          Data="M8,5 L19,12 L8,19 Z"
                                          Fill="{DynamicResource PrimaryAccentBrush}"
                                          Width="10" Height="10" Stretch="Uniform"
                                          HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <!-- Volume Slider -->
                                <Slider x:Name="VolumeSlider" Width="60" Margin="6,0,0,0"
                                        Minimum="0" Maximum="1" Value="0.5"
                                        VerticalAlignment="Center"
                                        ValueChanged="VolumeSlider_ValueChanged"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Auth Forms Container -->
                    <Grid VerticalAlignment="Center" Margin="50">
                        <!-- Login Form -->
                        <StackPanel x:Name="LoginForm">
                            <TextBlock Text="Welcome back"
                                       FontSize="28" FontWeight="Bold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="Sign in to your account"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,8,0,35"/>

                            <TextBlock Text="USERNAME" Style="{DynamicResource MutedText}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <TextBox x:Name="LoginUsername" Style="{DynamicResource ModernTextBox}" Margin="0,0,0,20"/>

                            <TextBlock Text="PASSWORD" Style="{DynamicResource MutedText}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <PasswordBox x:Name="LoginPassword" Style="{DynamicResource ModernPasswordBox}" Margin="0,0,0,20"/>

                            <CheckBox x:Name="RememberMeCheckbox" Content="Remember username"
                                      Foreground="{DynamicResource TextSecondaryBrush}"
                                      Margin="0,0,0,25" FontSize="12"
                                      Checked="RememberMe_Changed" Unchecked="RememberMe_Changed"/>

                            <Button x:Name="LoginButton" Style="{DynamicResource GlowButton}" Content="SIGN IN" Padding="0,15" FontSize="14" Click="LoginButton_Click"/>

                            <TextBlock HorizontalAlignment="Center" Margin="0,25,0,0" FontSize="13">
                                <Run Text="Don't have an account? " Foreground="{DynamicResource TextMutedBrush}"/>
                                <Hyperlink Click="ShowRegister_Click" Foreground="{DynamicResource PrimaryAccentBrush}" TextDecorations="None">Register</Hyperlink>
                            </TextBlock>

                            <!-- Discord Button (small) -->
                            <Border x:Name="DiscordButton" Background="{DynamicResource BackgroundElevatedBrush}"
                                    CornerRadius="8" Padding="12,8" Cursor="Hand" HorizontalAlignment="Center"
                                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                                    MouseEnter="DiscordButton_MouseEnter" MouseLeave="DiscordButton_MouseLeave"
                                    MouseLeftButtonUp="DiscordButton_Click" Margin="0,20,0,0">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"
                                          Fill="#5865F2" Width="16" Height="16" Stretch="Uniform" VerticalAlignment="Center"/>
                                    <TextBlock Text="Discord" FontSize="12" Margin="8,0,0,0"
                                               Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Register Form -->
                        <StackPanel x:Name="RegisterForm" Visibility="Collapsed">
                            <TextBlock Text="Create account"
                                       FontSize="28" FontWeight="Bold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="Join us today"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,8,0,30"/>

                            <TextBlock Text="USERNAME" Style="{DynamicResource MutedText}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <TextBox x:Name="RegisterUsername" Style="{DynamicResource ModernTextBox}" Margin="0,0,0,16"/>

                            <TextBlock Text="EMAIL" Style="{DynamicResource MutedText}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <TextBox x:Name="RegisterEmail" Style="{DynamicResource ModernTextBox}" Margin="0,0,0,16"/>

                            <TextBlock Text="PASSWORD" Style="{DynamicResource MutedText}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <PasswordBox x:Name="RegisterPassword" Style="{DynamicResource ModernPasswordBox}" Margin="0,0,0,16"/>

                            <TextBlock Text="CONFIRM PASSWORD" Style="{DynamicResource MutedText}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <PasswordBox x:Name="RegisterConfirmPassword" Style="{DynamicResource ModernPasswordBox}" Margin="0,0,0,25"/>

                            <Button x:Name="RegisterButton" Style="{DynamicResource GlowButton}" Content="CREATE ACCOUNT" Padding="0,15" FontSize="14" Click="RegisterButton_Click"/>

                            <TextBlock HorizontalAlignment="Center" Margin="0,25,0,0" FontSize="13">
                                <Run Text="Already have an account? " Foreground="{DynamicResource TextMutedBrush}"/>
                                <Hyperlink Click="ShowLogin_Click" Foreground="{DynamicResource PrimaryAccentBrush}" TextDecorations="None">Sign in</Hyperlink>
                            </TextBlock>
                        </StackPanel>

                        <!-- Logged In View -->
                        <StackPanel x:Name="LoggedInPanel" Visibility="Collapsed">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,35">
                                <Border Width="64" Height="64" CornerRadius="32"
                                        Background="{DynamicResource BackgroundElevatedBrush}"
                                        BorderBrush="{DynamicResource PrimaryAccentBrush}" BorderThickness="2">
                                    <TextBlock Text="U" FontSize="26" FontWeight="SemiBold"
                                               Foreground="{DynamicResource PrimaryAccentBrush}"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <StackPanel Margin="18,0,0,0" VerticalAlignment="Center">
                                    <TextBlock x:Name="UsernameDisplay" Text="Username" FontSize="20" FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock Text="Ready to play" FontSize="13" Foreground="{DynamicResource TextMutedBrush}" Margin="0,4,0,0"/>
                                </StackPanel>
                            </StackPanel>

                            <Button x:Name="PlayButton" Style="{DynamicResource GlowButton}" Padding="0,18" FontSize="16" Click="PlayButton_Click">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="M8,5 L19,12 L8,19 Z" Fill="White" Width="18" Height="18" Stretch="Uniform" Margin="0,0,12,0"/>
                                    <TextBlock Text="PLAY NOW" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <Button x:Name="LogoutButton" Style="{DynamicResource MenuButton}" Content="Logout" HorizontalAlignment="Center" Margin="0,25,0,0" Padding="28,12" FontSize="13" Click="LogoutButton_Click"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>

            <!-- Audio Player (hidden) -->
            <MediaElement x:Name="BgmPlayer" LoadedBehavior="Manual" UnloadedBehavior="Manual"
                          Volume="0.5" MediaEnded="BgmPlayer_MediaEnded" Visibility="Collapsed"/>

            <!-- Credits Button (bottom right corner) -->
            <Border x:Name="CreditsButton" Grid.ColumnSpan="2"
                    Width="28" Height="28" CornerRadius="14"
                    Background="{DynamicResource BackgroundCardBrush}"
                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                    HorizontalAlignment="Right" VerticalAlignment="Bottom"
                    Margin="0,0,15,15" Cursor="Hand"
                    MouseEnter="CreditsButton_MouseEnter" MouseLeave="CreditsButton_MouseLeave"
                    MouseLeftButtonUp="CreditsButton_Click">
                <TextBlock Text="?" FontSize="14" FontWeight="Bold"
                           Foreground="{DynamicResource TextMutedBrush}"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>

            <!-- Credits Popup -->
            <Border x:Name="CreditsPopup" Grid.ColumnSpan="2" Visibility="Collapsed"
                    Background="#E0000000" CornerRadius="12">
                <Border Background="{DynamicResource BackgroundCardBrush}"
                        CornerRadius="12" Padding="30"
                        HorizontalAlignment="Center" VerticalAlignment="Center"
                        BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                        MinWidth="300">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="20" ShadowDepth="0" Color="#000000" Opacity="0.5"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="CREDITS" FontSize="18" FontWeight="Bold"
                                   Foreground="{DynamicResource PrimaryAccentBrush}"
                                   HorizontalAlignment="Center" Margin="0,0,0,20"/>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Backend" FontSize="11" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,0,4"/>
                            <TextBlock Text="Level &amp; NutNNut" FontSize="14"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,20">
                            <TextBlock Text="Frontend Launcher" FontSize="11" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}" Margin="0,0,0,4"/>
                            <TextBlock Text="Lynx" FontSize="14"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <Border Background="{DynamicResource PrimaryAccentBrush}"
                                CornerRadius="6" Padding="20,10" Cursor="Hand"
                                HorizontalAlignment="Center"
                                MouseLeftButtonUp="CloseCredits_Click">
                            <TextBlock Text="Close" FontSize="12" FontWeight="SemiBold"
                                       Foreground="White" HorizontalAlignment="Center"/>
                        </Border>
                    </StackPanel>
                </Border>
            </Border>

            <!-- Loading Overlay -->
            <Border x:Name="LoadingOverlay" Grid.ColumnSpan="2" Background="#0A0A0A" CornerRadius="12">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <!-- Spinning loader -->
                    <Border Width="50" Height="50" CornerRadius="25" BorderThickness="4" BorderBrush="{DynamicResource PrimaryAccentBrush}">
                        <Border.RenderTransform>
                            <RotateTransform x:Name="LoaderRotation" CenterX="25" CenterY="25"/>
                        </Border.RenderTransform>
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="Loaded">
                                <BeginStoryboard>
                                    <Storyboard RepeatBehavior="Forever">
                                        <DoubleAnimation Storyboard.TargetName="LoaderRotation"
                                                         Storyboard.TargetProperty="Angle"
                                                         From="0" To="360" Duration="0:0:1"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                        <Border Width="10" Height="10" CornerRadius="5" Background="{DynamicResource PrimaryAccentBrush}"
                                VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,-2,0,0"/>
                    </Border>
                    <TextBlock Text="RoyalStory" FontSize="24" FontWeight="Bold" Margin="0,25,0,5"
                               Foreground="{DynamicResource PrimaryAccentBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Loading..." FontSize="13" Foreground="{DynamicResource TextMutedBrush}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
